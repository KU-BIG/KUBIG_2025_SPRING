# -*- coding: utf-8 -*-
"""ì¢…í•©ì½”ë“œ.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1c5RcWZGZ7xdI6hCdGw1LVqGv-IHcwDRr
"""

import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

from google.colab import drive
drive.mount('/content/drive')

!pip install tabulate
from tabulate import tabulate

# í•œê¸€ í°íŠ¸ ì„¤ì •
!apt-get -qq install fonts-nanum*
import matplotlib.font_manager as fm
font_path = '/usr/share/fonts/truetype/nanum/NanumGothic.ttf'
fm.fontManager.addfont(font_path)
plt.rc('font', family='NanumGothic')

score = pd.read_excel("/content/drive/MyDrive/Colab Notebooks/KUBIG/25-1/Conference/ìµœì¢…_ì‚°ì—…ì•ˆì •ë„.xlsx")
score

def industry_recommend():
    # ì‚¬ìš©ì ì…ë ¥ ë°›ê¸°
    age = input("ë³¸ì¸ì˜ ì—°ë ¹ëŒ€ë¥¼ ì„ íƒí•˜ì„¸ìš” (1: 50ì„¸~54ì„¸ / 2: 55ì„¸~59ì„¸ / 3: 60ì„¸ ì´ìƒ): ")
    gender = input("ë³¸ì¸ì˜ ì„±ë³„ì„ ì„ íƒí•˜ì„¸ìš” (1: ë‚¨ / 2: ì—¬): ")
    edu = input("ë³¸ì¸ì˜ ìµœì¢…í•™ë ¥ì„ ì„ íƒí•˜ì„¸ìš” (1: ì¤‘ì¡¸ì´í•˜ / 2: ê³ ì¡¸ / 3: ì „ë¬¸ëŒ€ì¡¸ / 4: ëŒ€ì¡¸ì´ìƒ): ")
    option = input("ê³ ìš©ì•ˆì •ë„ì™€ ì¬í•´ì•ˆì „ì„± ê°ê°ì— ë¶€ì—¬í•  ê°€ì¤‘ì¹˜ë¥¼ ì„ íƒí•˜ì„¸ìš” (1: 5:5 / 2: 3:7 / 3: 7:3): ")

    if age == '1':
      target_age = '50ì„¸~54ì„¸'
    elif age == '2':
      target_age = '55ì„¸~59ì„¸'
    elif age == '3':
      target_age = '60ì„¸ ì´ìƒ'

    if gender == '1':
      target_gender = 'ë‚¨'
    elif gender == '2':
      target_gender = 'ì—¬'

    if edu == '1':
      target_edu = 'ì¤‘ì¡¸ì´í•˜'
    elif edu == '2':
      target_edu = 'ê³ ì¡¸'
    elif edu == '3':
      target_edu = 'ì „ë¬¸ëŒ€ì¡¸'
    elif edu == '4':
      target_edu = 'ëŒ€ì¡¸ì´ìƒ'

    if option == '1':
      target_option = 'ìµœì¢…ì ìˆ˜(5:5)'
    elif option == '2':
      target_option = 'ìµœì¢…ì ìˆ˜(3:7)'
    elif option == '3':
      target_option = 'ìµœì¢…ì ìˆ˜(7:3)'

    # í•„í„°ë§
    target_df = score[
        (score['ì—°ë ¹'] == target_age) &
        (score['ì„±ë³„'] == target_gender) &
        (score['í•™ë ¥'] == target_edu)
    ]

    # ì‚°ì—… ì¤‘ë¶„ë¥˜ë³„ ìƒìœ„ 15ê°œ ì¶œë ¥
    top15 = target_df[['ì‚°ì—…_ì¤‘ë¶„ë¥˜', target_option]].sort_values(by=target_option, ascending=False).head(15).reset_index(drop=True)
    print("\nğŸ“Š ì•ˆì „ì„±ì´ ë†’ì€ ì‚°ì—… ì¤‘ë¶„ë¥˜ ìƒìœ„ 15ê°œ ì¶”ì²œ:")
    print(tabulate(top15, headers='keys', tablefmt='psql'))

    # íˆíŠ¸ë§µìš© ë°ì´í„° ë§Œë“¤ê¸°
    heatmap_df = target_df.groupby('ì‚°ì—…_ëŒ€ë¶„ë¥˜')[target_option].mean()
    heatmap_df = heatmap_df.copy().sort_values(ascending=False).to_frame(name=target_option)

    # íˆíŠ¸ë§µ ê·¸ë¦¬ê¸°
    plt.figure(figsize=(6, len(heatmap_df) * 0.4))
    sns.heatmap(
        heatmap_df,
        annot=True, cmap='coolwarm_r', fmt=".3f", linewidths=0.5, cbar=True
    )
    plt.title(f"{target_age} {target_gender}ì {target_edu} ë…¸ë™ìì˜ ì‚°ì—…ë³„ ì•ˆì •ë„", fontweight='bold')
    plt.ylabel("ì‚°ì—…ë¶„ë¥˜")
    plt.tight_layout()
    plt.show()

industry_recommend()

industry_recommend()